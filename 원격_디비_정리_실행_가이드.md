# MASLABS 원격 Supabase 디비 정리 실행 가이드

## 📋 개요
이 가이드는 원격 Supabase 디비에서 불필요한 테이블들을 삭제하고, 새로운 직원 데이터와 OP1~OP10 업무 유형을 설정하는 방법을 설명합니다.

## 🎯 목표
- 불필요한 테이블들 삭제
- 핵심 테이블 구조 정리
- 9명 직원 데이터 설정
- OP1~OP10 업무 유형 구성
- 로컬 디비와 동일한 구조로 통일

## 📁 파일
- **SQL 파일**: `MASLABS_REMOTE_DB_CLEANUP_FINAL.sql`
- **실행 가이드**: `원격_디비_정리_실행_가이드.md`

## 🚀 실행 단계

### 1단계: 원격 Supabase Studio 접속
1. 브라우저에서 [Supabase Dashboard](https://supabase.com/dashboard) 접속
2. MASLABS-DB 프로젝트 선택
3. 왼쪽 메뉴에서 **SQL Editor** 클릭

### 2단계: SQL 파일 실행
1. **SQL Editor**에서 **New query** 클릭
2. `MASLABS_REMOTE_DB_CLEANUP_FINAL.sql` 파일의 내용을 복사하여 붙여넣기
3. **Run** 버튼 클릭하여 실행

### 3단계: 실행 결과 확인
실행 후 다음과 같은 메시지들이 표시되어야 합니다:

```
=== 현재 원격 디비 상태 ===
총 테이블 수: XX개
테이블 목록: ...

✅ 부서 구조 업데이트 완료
✅ 직급 데이터 업데이트 완료
✅ 역할 데이터 업데이트 완료
✅ OP1~OP10 업무 유형 설정 완료
✅ 9명 직원 데이터 삽입 완료

=== 원격 디비 정리 완료 ===

📊 최종 상태:
   • 남은 테이블 수: 9개
   • 직원 수: 9명
   • 업무 유형: 10개 (OP1~OP10)
   • 부서 수: 6개

🏢 핵심 부서:
   • 운영팀(HQ): 본사 운영 관리
   • 싱싱팀(SING): 싱싱 관련 업무
   • 마스팀(MAS): 마스 관련 업무

👥 직원 구성:
   • 김탁수(WHA): 운영팀, 대표이사, admin
   • 이은정(STE): 운영팀, 부장, manager
   • 허상원(HEO): 운영팀, 사원, employee
   • 하상희(HA): 디자인팀, 파트타임, part_time
   • 최형호(EAR): 마스팀, 과장, team_lead
   • 박진(JIN): 마스팀, 팀원, part_time
   • 최주희(JH): 마스팀, 파트타임, part_time
   • 나수진(NA): 싱싱팀, 과장, team_lead
   • 홍미정(HONG): 싱싱팀, 파트타임, part_time

✅ 원격 디비가 성공적으로 정리되었습니다!
✅ 로컬 디비와 동일한 구조로 설정되었습니다!
```

## 📊 삭제되는 테이블들
다음 테이블들이 삭제됩니다:
- `audit_logs` (감사 로그)
- `contracts` (계약서)
- `documents` (문서)
- `employee_details` (직원 상세)
- `notifications` (알림)
- `operation_type_permissions` (업무 유형 권한)
- `operation_types_backup` (업무 유형 백업)
- `operation_types_by_points` (점수별 업무 유형)
- `performance_metrics` (성과 지표)
- `salaries` (급여)
- `sessions` (세션)
- `task_performance_summary` (업무 성과 요약)
- `kpi_operation_types_summary` (KPI 업무 유형 요약)
- `monthly_attendance_summary` (월별 출근 요약)

## 🏗️ 생성/유지되는 테이블들
다음 테이블들이 유지되거나 생성됩니다:
- `departments` (부서)
- `employees` (직원)
- `operation_types` (업무 유형)
- `positions` (직급)
- `roles` (역할)
- `schedules` (스케줄)
- `employee_tasks` (직원 업무)
- `team_members` (팀 멤버)
- `daily_performance_records` (일일 성과 기록)

## 👥 직원 정보
모든 직원의 핀번호는 `1234`로 설정됩니다.

| 직원ID | 이름 | 닉네임 | 부서 | 직급 | 역할 | 전화번호 | 비밀번호 |
|--------|------|--------|------|------|------|----------|----------|
| MASLABS-001 | 김탁수 | WHA | 운영팀 | 대표이사 | admin | 010-6669-9000 | 66699000 |
| MASLABS-002 | 이은정 | STE | 운영팀 | 부장 | manager | 010-3243-3099 | 32433099 |
| MASLABS-003 | 허상원 | HEO | 운영팀 | 사원 | employee | 010-8948-4501 | 89484501 |
| MASLABS-004 | 하상희 | HA | 디자인팀 | 파트타임 | part_time | 010-2576-7885 | 25767885 |
| MASLABS-005 | 최형호 | EAR | 마스팀 | 과장 | team_lead | 010-7128-4590 | 71284590 |
| MASLABS-006 | 박진 | JIN | 마스팀 | 팀원 | part_time | 010-9132-4337 | 91324337 |
| MASLABS-007 | 최주희 | JH | 마스팀 | 파트타임 | part_time | 010-7110-2030 | 71102030 |
| MASLABS-008 | 나수진 | NA | 싱싱팀 | 과장 | team_lead | 010-2391-4431 | 23914431 |
| MASLABS-009 | 홍미정 | HONG | 싱싱팀 | 파트타임 | part_time | 010-8589-2308 | 85892308 |

## 🔧 업무 유형 (OP1~OP10)

| 코드 | 업무명 | 설명 | 점수 | 대상 역할 |
|------|--------|------|------|-----------|
| OP1 | 전화 판매(신규) | 신규 고객 전화 판매 | 20 | 모든 역할 |
| OP2 | 전화 판매(재구매/부품) | 재구매/부품 전화 판매 | 15 | 모든 역할 |
| OP3 | 오프라인 판매(신규) | 신규 고객 오프라인 판매 | 40 | 모든 역할 |
| OP4 | 오프라인 판매(재구매/부품) | 재구매/부품 오프라인 판매 | 30 | 모든 역할 |
| OP5 | CS 응대(기본) | 프로모션 설명, 인트라넷/노션 정보 입력 | 8 | 모든 역할 |
| OP6 | A/S 처리(고급) | 고급 A/S 처리 | 15 | admin, manager, team_lead |
| OP7 | 환불 방어 | 환불 방어 성공 | 25 | 모든 역할 |
| OP8 | 환불 처리 | 기존 판매 점수 그대로 차감 | 0 | 모든 역할 |
| OP9 | 택배 입고/출고/회수 | 상품 관련 택배 처리 | 8 | 모든 역할 |
| OP10 | 기타 택배/서비스 | 음료/소모품/선물 등 기타 | 5 | 모든 역할 |

## ⚠️ 주의사항
1. **백업**: 실행 전 원격 디비 백업을 권장합니다
2. **실행 시간**: 대용량 데이터의 경우 몇 분 정도 소요될 수 있습니다
3. **에러 처리**: SQL에 에러 처리 로직이 포함되어 있어 안전하게 실행됩니다
4. **롤백**: 문제 발생 시 Supabase의 백업 기능을 사용하여 복구할 수 있습니다

## 🔍 실행 후 확인사항
1. **Table Editor**에서 테이블 목록 확인
2. **employees** 테이블에서 9명 직원 데이터 확인
3. **operation_types** 테이블에서 OP1~OP10 확인
4. **departments** 테이블에서 부서 구조 확인

## 📞 문제 해결
실행 중 문제가 발생하면:
1. 에러 메시지 확인
2. Supabase 로그 확인
3. 필요시 백업에서 복구
4. 개발팀에 문의

## ✅ 완료 확인
모든 단계가 완료되면:
- 로컬 디비와 원격 디비가 동일한 구조
- 9명 직원 데이터 설정 완료
- OP1~OP10 업무 유형 구성 완료
- 불필요한 테이블 정리 완료

---
**생성일**: 2025-08-25  
**버전**: 2.0.0  
**담당자**: 개발팀
