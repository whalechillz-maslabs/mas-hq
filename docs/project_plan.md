# MASLABS 직원 관리 시스템 프로젝트 계획

## 📋 프로젝트 개요
MASLABS의 직원 관리 시스템으로, 출근 관리, 급여 조회, 업무 기록, 조직도 등의 기능을 제공하는 웹 애플리케이션입니다.

## 🚀 최신 업데이트 (2025-08-21)

### ✨ 권한 시스템 대폭 개선 (옵션 A)
- **총관리자 (admin)**: 모든 스케줄 수정 가능 (본인 + 타인, 과거 + 미래)
- **매니저 (manager)**: 본인 스케줄만 과거 수정 가능, 타인은 미래만
- **일반 직원 (employee)**: 본인 스케줄의 미래 시간만 수정 가능
- **시각적 권한 표시**: 각 역할별 권한 범위 명확 표시

### 🏢 출근 체크 시스템 신규 구현
- **실시간 출근/퇴근 체크**: GPS 위치 정보와 함께 기록
- **오늘의 스케줄 관리**: 당일 예정된 근무 시간 확인 및 체크
- **월간 출근 기록**: 이번 달 전체 출근 현황 조회
- **상태별 표시**: 대기/근무중/완료 상태 시각적 구분
- **지역 정보 저장**: 출근/퇴근 위치 자동 기록

### 🎯 일괄 입력 기능 완전 개선
- **시간 단위 분할**: 10시-18시 → 10-11, 11-12, 12-13... 각각 별도 스케줄
- **연속 스케줄 지원**: 원하는 시간 범위를 1시간 단위로 자동 분할
- **요일별 선택**: 월~일요일 중 원하는 요일만 선택 가능
- **기존 스케줄 관리**: 새 일괄 입력 시 기존 스케줄 자동 삭제 후 생성

### 🎨 스케줄 표시 최적화
- **호버 툴팁**: 마우스 오버 시 상세 정보 표시 (시간, 인원수, 참여자 목록)
- **개수 표시**: 각 시간대별 근무자 수 숫자로 표시 (데스크톱만)
- **향상된 시각적 피드백**: 클릭 가능한 요소 hover 시 확대 효과
- **권한별 메시지**: 역할에 따른 맞춤형 오류 메시지

## 📁 파일 구조

### 새로 추가된 파일들
- `src/app/attendance/page.tsx` - 출근 관리 페이지 (신규)
- `src/app/admin/employee-schedules/page.tsx` - 직원별 스케줄 관리 페이지 (신규)
- `tests/complete-system-test.spec.ts` - 전체 시스템 통합 테스트

### 수정된 파일들
- `src/app/schedules/page.tsx` - 권한 시스템 개선, 스케줄 표시 최적화
- `src/app/dashboard/page.tsx` - 출근 관리 메뉴 추가, 직원별 스케줄 관리 메뉴 추가
- `src/app/admin/employee-schedules/page.tsx` - 권한 체크 로직 수정, 네비게이션 개선
- `docs/project_plan.md` - 프로젝트 문서 업데이트

## 🎯 주요 기능

### 1. 권한 기반 스케줄 관리 시스템 (대폭 개선)
- **역할별 세분화 권한**: admin > manager > employee 순서로 권한 차등 적용
- **시간 기반 제어**: 과거/미래 시간에 따른 수정 권한 차별화
- **실시간 권한 검증**: 로그인 사용자 역할에 따른 동적 UI 제어
- **명확한 권한 표시**: 각 역할별 권한 범위 화면에 표시
- **관리자 전용 직원별 스케줄 관리**: 모든 직원의 스케줄을 관리자가 직접 관리 가능
- **데이터베이스 기반 권한 체크**: role_id를 통해 정확한 권한 검증

### 2. 출근 체크 시스템 (신규)
- **원터치 체크인/체크아웃**: 간단한 버튼 클릭으로 출근/퇴근 기록
- **GPS 위치 기록**: 출근/퇴근 시 자동 위치 정보 저장
- **스케줄 연동**: 당일 예정된 근무 스케줄과 실제 출근 시간 비교
- **월간 기록 조회**: 이번 달 전체 출근 현황 한눈에 확인
- **상태 관리**: 대기/근무중/완료 상태별 색상 구분

### 3. 일괄 스케줄 입력 시스템 (완전 개선)
- **시간 범위 자동 분할**: 입력한 시간 범위를 1시간 단위로 자동 분할
- **요일별 선택 적용**: 원하는 요일에만 선택적으로 스케줄 적용
- **스마트 덮어쓰기**: 기존 스케줄 자동 삭제 후 새 스케줄 생성
- **실시간 피드백**: 생성될 스케줄 개수 미리 표시

### 4. 스케줄 표시 최적화 (신규)
- **상세 정보 툴팁**: 호버 시 시간, 인원수, 참여자 목록 표시
- **근무자 수 표시**: 각 시간대별 근무자 수 숫자로 표시 (PC환경)
- **향상된 인터랙션**: 클릭 가능한 요소에 호버 효과 및 확대 애니메이션
- **접근성 개선**: title 속성으로 스크린 리더 지원

### 5. 권한 시스템 (옵션 A 구조)
- **총관리자 (admin)**: 
  - 모든 스케줄 수정 가능 (본인 + 타인)
  - 과거 시간도 수정 가능
  - 모든 관리자 메뉴 접근
- **매니저 (manager)**:
  - 본인 스케줄은 과거라도 수정 가능
  - 타인 스케줄은 미래만 수정 가능
  - 제한된 관리자 메뉴 접근
- **일반 직원 (employee)**:
  - 본인 스케줄의 미래 시간만 수정 가능
  - 기본 기능만 접근

### 6. 모바일 최적화
- **반응형 디자인**: 모든 화면 크기 지원
- **터치 친화적**: 큰 버튼과 직관적 인터페이스
- **그라데이션 배경**: 시각적 매력도 향상
- **카드 레이아웃**: 깔끔하고 현대적인 디자인

## 🔐 권한 구조

### 역할별 스케줄 수정 권한
1. **admin (총관리자)**
   - ✅ 본인 스케줄 (과거 + 미래)
   - ✅ 타인 스케줄 (과거 + 미래)
   - 🎯 모든 상황에서 수정 가능

2. **manager (매니저)**
   - ✅ 본인 스케줄 (과거 + 미래)
   - ✅ 타인 스케줄 (미래만)
   - ❌ 타인 스케줄 (과거)

3. **employee (일반직원)**
   - ✅ 본인 스케줄 (미래만)
   - ❌ 본인 스케줄 (과거)
   - ❌ 타인 스케줄 (모든 시간)

### 메뉴별 접근 권한
1. **모든 직급** (admin, manager, team_lead, employee, part_time)
   * /schedules - 근무 스케줄
   * /attendance - 출근 관리 (신규)
   * /salary - 급여 조회
   * /tasks - 업무 기록
   * /organization - 조직도
   * /profile - 개인정보 관리

2. **관리자 전용** (admin)
   * /admin/system-settings - 시스템 설정
   * /admin/employee-migration - 직원 데이터 관리
   * /admin/employee-schedules - 직원별 스케줄 관리 (신규)

3. **관리자 + 매니저** (admin, manager)
   * /admin/hr-policy - 인사정책 관리
   * /admin/team-management - OP 팀장 설정
   * /admin/employee-management - 직원 관리

4. **관리자 + 매니저 + OP팀장** (admin, manager, team_lead)
   * /admin/team-evaluation - 팀원 평가
   * /admin/attendance-management - 출근 관리

## 🗄️ 데이터베이스 구조

### 주요 테이블
- **employees**: 직원 정보 (이름, 전화번호, 부서, 직책, 역할)
- **schedules**: 근무 스케줄 (날짜, 시작/종료 시간, 실제 출근/퇴근 시간, 위치 정보)
- **departments**: 부서 정보 (마스팀, 싱싱팀, 경영지원팀)
- **positions**: 직책 정보 (대표이사, 이사, 팀장, 사원)
- **roles**: 역할 정보 (admin, manager, team_lead, employee, part_time)

### 출근 관리 관련 필드 (schedules 테이블)
- **actual_start**: 실제 출근 시간
- **actual_end**: 실제 퇴근 시간
- **check_in_location**: 출근 시 GPS 위치 정보
- **check_out_location**: 퇴근 시 GPS 위치 정보
- **status**: 스케줄 상태 (pending/in_progress/completed)

### 현재 직원 데이터
- **MASLABS-001**: 시스템 관리자 (admin) - 모든 권한
- **MASLABS-002**: 이은정(STE) - 경영지원팀 이사 (manager) - 제한된 관리 권한
- **MASLABS-004**: 박진(JIN) - 마스팀 사원 (part_time) - 기본 권한

## 🚀 배포 정보

### Vercel 배포
- **프로덕션 URL**: https://mas-hcbjucrdu-whalechillz-maslabs-projects.vercel.app
- **GitHub 연동**: https://github.com/whalechillz-maslabs/mas-hq
- **자동 배포**: main 브랜치 푸시 시 자동 배포

### 환경 설정
- **로컬 개발**: Docker Supabase
- **프로덕션**: 원격 Supabase
- **환경 변수**: .env.local (로컬), .env.production (프로덕션)

## 🧪 테스트 현황

### Playwright 테스트 (최신)
- **complete-system-test.spec.ts**: 전체 시스템 통합 테스트
  - 권한별 로그인 테스트 (admin, manager, employee)
  - 출근 관리 시스템 테스트
  - 일괄 스케줄 입력 테스트
  - 권한별 메뉴 접근 테스트

### 기존 테스트
- **스케줄 시스템 테스트**: 이은정 로그인 및 스케줄 확인
- **권한 테스트**: admin, manager, team_lead 권한 확인
- **UI 테스트**: 로그인, 대시보드, 프로필 페이지

## 📈 향후 계획

### 단기 목표 (1-2주)
- [ ] 원격 Supabase 데이터 동기화 완료
- [ ] 통합 Playwright 테스트 완전 통과
- [ ] 출근 관리 시스템 고도화
- [ ] 스케줄 알림 시스템 추가

### 중기 목표 (1개월)
- [ ] 실시간 알림 시스템 구축
- [ ] 출근 패턴 분석 대시보드
- [ ] 스케줄 충돌 자동 감지 및 해결
- [ ] 모바일 앱 버전 개발

### 장기 목표 (3개월)
- [ ] AI 기반 스케줄 최적화
- [ ] 외부 시스템 연동 (급여, 인사)
- [ ] 고급 분석 및 리포팅
- [ ] 자동화된 스케줄 관리

## 🔧 기술 스택

### Frontend
- **Next.js 15.4.6**: React 기반 프레임워크
- **TypeScript**: 타입 안전성
- **TailwindCSS**: 스타일링
- **Lucide React**: 아이콘
- **date-fns**: 날짜 처리

### Backend
- **Supabase**: PostgreSQL 데이터베이스
- **Supabase Auth**: 인증 시스템
- **Row Level Security**: 데이터 보안
- **Geolocation API**: 위치 정보 수집

### Testing
- **Playwright**: E2E 테스트
- **TypeScript**: 타입 체크

### Deployment
- **Vercel**: 자동 배포
- **GitHub**: 버전 관리
- **Docker**: 로컬 개발 환경

## 🎨 UI/UX 개선사항

### 권한 시스템 UI
- **역할별 색상 코딩**: admin(빨강), manager(노랑), employee(파랑)
- **권한 범위 표시**: 각 역할별 수정 가능 범위 명시
- **동적 메시지**: 권한에 따른 맞춤형 안내 메시지

### 출근 관리 시스템 UI
- **상태별 색상**: 대기(회색), 근무중(파랑), 완료(초록)
- **실시간 시계**: 현재 시간 실시간 표시
- **위치 아이콘**: GPS 정보 기록 여부 표시
- **월간 기록 요약**: 스크롤 가능한 컴팩트한 리스트

### 스케줄 최적화 UI
- **호버 툴팁**: 마우스 오버 시 상세 정보 팝업
- **숫자 표시**: 각 시간대별 근무자 수 중앙 표시
- **확대 애니메이션**: 클릭 가능한 요소에 hover:scale-105 효과
- **접근성 향상**: title 속성으로 스크린 리더 지원

## 📞 연락처
- **개발팀**: MASLABS 개발팀
- **GitHub**: https://github.com/whalechillz-maslabs/mas-hq
- **배포 URL**: https://mas-hcbjucrdu-whalechillz-maslabs-projects.vercel.app

---
*마지막 업데이트: 2025-08-21 - 권한 시스템 개선 및 출근 관리 시스템 추가*