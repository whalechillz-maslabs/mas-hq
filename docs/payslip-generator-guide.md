# 급여 명세서 생성 기능 가이드

## 개요
급여 명세서 생성 기능은 관리자가 직원의 급여 명세서를 생성하고 발행할 수 있는 기능입니다.

## 주요 기능

### 1. 직원 선택
- 드롭다운 메뉴에서 급여 명세서를 생성할 직원을 선택
- 직원명, 직원번호, 부서 정보가 표시됨

### 2. 급여 명세서 생성
- 선택된 직원의 기본 급여 정보를 기반으로 자동 계산
- 기본급, 연장수당, 인센티브, 포인트 보너스 계산
- 3.3% 사업소득세 자동 계산
- 실수령액 자동 계산

### 3. 발행 전 체크리스트
다음 항목들을 체크해야 발행 가능:
- ✅ 기본급 금액 확인
- ✅ 연장수당 확인
- ✅ 인센티브 확인
- ✅ 포인트 보너스 확인
- ✅ 세금 계산 확인 (3.3% 사업소득세)
- ✅ 실수령액 확인
- ✅ 최종 검토 완료

### 4. 급여 명세서 발행
- 모든 체크 항목 완료 후 발행 버튼 활성화
- 발행 시 데이터베이스에 급여 정보 저장
- 발행 완료 후 직원 관리 페이지로 이동

## 사용 방법

### 1. 접근 방법
1. 대시보드에서 "급여 명세서 생성" 버튼 클릭
2. 또는 `/admin/payslip-generator` URL로 직접 접근

### 2. 급여 명세서 생성 과정
1. **직원 선택**: 드롭다운에서 직원 선택
2. **명세서 생성**: "급여 명세서 생성" 버튼 클릭
3. **내용 확인**: 생성된 급여 정보 확인
4. **체크리스트**: 모든 항목 체크
5. **발행**: "급여 명세서 발행" 버튼 클릭

### 3. 급여 계산 방식
- **기본급**: 직원 정보의 `monthly_salary` 값
- **연장수당**: 기본급의 10%
- **인센티브**: 기본급의 5%
- **포인트 보너스**: 0원 (추후 확장 가능)
- **총 수입**: 기본급 + 연장수당 + 인센티브 + 포인트 보너스
- **세금**: 총 수입의 3.3% (사업소득세)
- **실수령액**: 총 수입 - 세금

## 데이터베이스 구조

### salaries 테이블
```sql
CREATE TABLE salaries (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  employee_id UUID REFERENCES employees(id),
  payment_date DATE NOT NULL,
  base_salary INTEGER NOT NULL,
  overtime_pay INTEGER DEFAULT 0,
  incentive INTEGER DEFAULT 0,
  deduction_amount INTEGER DEFAULT 0,
  net_salary INTEGER NOT NULL,
  status VARCHAR(20) DEFAULT 'pending',
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

## 보안 및 권한

### 접근 권한
- 관리자(admin) 권한 필요
- 대시보드에서 관리자 메뉴에만 표시

### 데이터 보호
- 급여 정보는 암호화되어 저장
- 발행 전 모든 항목 체크 필수
- 발행 후 수정 불가 (데이터 무결성 보장)

## 확장 가능한 기능

### 1. 포인트 보너스 계산
- 직원의 업무 성과에 따른 포인트 계산
- `employee_tasks` 테이블과 연동

### 2. 다양한 급여 유형
- 시급제 직원 지원
- 일급제 직원 지원
- 성과급 계산

### 3. PDF 생성
- 급여 명세서 PDF 다운로드
- 이메일 자동 발송

### 4. 급여 이력 관리
- 과거 급여 명세서 조회
- 급여 변동 이력 추적

## 문제 해결

### 자주 발생하는 문제

1. **직원 목록이 비어있음**
   - `employees` 테이블에 데이터가 있는지 확인
   - 데이터베이스 연결 상태 확인

2. **급여 명세서 생성 실패**
   - 직원의 `monthly_salary` 값이 설정되어 있는지 확인
   - 데이터베이스 권한 확인

3. **발행 실패**
   - 모든 체크 항목이 완료되었는지 확인
   - 데이터베이스 연결 상태 확인

### 로그 확인
- 브라우저 개발자 도구 콘솔에서 오류 메시지 확인
- 네트워크 탭에서 API 요청 상태 확인

## 업데이트 이력

### v1.0.0 (2025-01-05)
- 초기 급여 명세서 생성 기능 구현
- 기본 급여 계산 로직 구현
- 발행 전 체크리스트 기능 구현
- 데이터베이스 연동 구현
